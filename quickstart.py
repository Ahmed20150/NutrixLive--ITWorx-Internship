import os
import requests
import json
import openai



def askGpt(promptt):

    openai.api_key = os.getenv("AZURE_OPENAI_KEY")
    openai.api_base = os.getenv("AZURE_OPENAI_ENDPOINT")
    openai.api_type = 'azure'
    openai.api_version = '2023-05-15' 
    response = openai.Completion.create(
    engine='NutrixLife',
    prompt=promptt,
    max_tokens=2048,  # Adjust the value as needed
    temperature=0.5,  # Adjust the value as needed
    top_p=0.05,
    stop=None
    )
    return response['choices'][0]['text']


#prompt = "Create a personalized Individualized Meal Plan Document that is tailored to the user's unique situation. Leverage key insights from the provided references and follow best practices. Create An Individualized Meal Plan Document , As a dietitian in the medical department, your task is to create an individualized meal plan document for patients based on their medical conditions, dietary preferences, and nutritional needs. The finished work will be used by the patients to follow a healthy and balanced diet that meets their specific requirements. The core success factors for this task are accuracy, attention to detail and ensure that their needs and preferences are taken into account. The meal plan document should be easy to understand and follow, and it should provide clear instructions on portion sizes, meal timings, and food choices. The impact of this task is significant as it can help patients manage their medical conditions, improve their overall health and wellbeing, and prevent complications related to poor nutrition. Use these references to create an individualized meal plan document . references :[{ title :Nutrition Therapy and Pathophysiology , author : Marcia Nelms, Kathryn P. Sucher, Sara Long Roth ,year : 2015 , keyInsights :[ Assessing the nutritional status of patients is essential for creating individualized meal plans that meet their specific needs. Consider the patient's medical conditions, dietary preferences, and lifestyle factors when creating a meal plan. , Provide clear instructions on portion sizes, meal timings, and food choices to ensure that the patient can understand and follow the plan effectively. ]},{ title : The Complete Idiot's Guide to Total Nutrition , author : Joy Bauer , year : 2005 ,  keyInsights :[ Use a variety of foods to ensure that the patient receives all the necessary nutrients. , Incorporate healthy fats, lean proteins, and complex carbohydrates into the meal plan. Encourage the patient to make gradual changes to their eating habits to ensure long-term success. ]},{ title : The Food Medic for Life: Easy recipes to help you live well every day , author : Dr. Hazel Wallac , year :2019 ,  keyInsights :[ Provide patients with simple and easy-to-follow recipes that align with their meal plan. Consider the patient's cultural background and food preferences when creating the meal plan. Encourage the patient to keep a food diary to track their progress and identify areas for improvement.]}], criteria :[{ name :    Accuracy ,description : The meal plan document accurately reflects the patient's medical conditions, dietary preferences, and nutritional needs. It provides the correct information on portion sizes, meal timings, and food choices. },{ name : Attention to detail , description : The meal plan document includes all necessary details and instructions for the patient to follow a healthy and balanced diet. It covers specific dietary requirements, potential food allergies or intolerances, and any restrictions or limitations.  Create a personalized nutrition plan in the following format based on the number of meals , for example if you were to provide 3 meals they should be in the following format : 1) Breakfast: \n - [Breakfast Item 1] \n   - [Sub-bullet 1]   \n - [Sub-bullet 2] \n- [Breakfast Item 2]\n- [Sub-bullet 1] \n- [Sub-bullet 2]\n 2) Lunch:\n- [Lunch Item 1]     \n- [Sub-bullet 1]\n- [Sub-bullet 2]\n- [Lunch Item 2]\n- [Sub-bullet 1]\n- [Sub-bullet 2]\n 3) Dinner:\n- [Dinner Item 1]\n- [Sub-bullet 1]\n- [Sub-bullet 2]\n- [Dinner Item 2]\n- [Sub-bullet 1]\n- [Sub-bullet 2] \n Calculate the BMR and Create a personalized meal based on the following data : age = 20 , weight = 92 , height = 191 ,he has allergies towards gluten and fish so exclude any ingredients containing fish and gluten , his activity dynamic is sitting at a desk all day ,he wants 5 meals per day and his desired weight is to be 80."
prompt =" I am creating a nutrition plan using openai api, i need you to generate a prompt that will always output an answer in the form of bullet points with the meal as a title and its content in sub bullet points . for example : , for example if you were to provide 3 meals they should be in the following format : 1) Breakfast: \n - [Breakfast Item 1] \n   - [Sub-bullet 1]   \n - [Sub-bullet 2] \n- [Breakfast Item 2]\n- [Sub-bullet 1] \n- [Sub-bullet 2]\n 2) Lunch:\n- [Lunch Item 1]     \n- [Sub-bullet 1]\n- [Sub-bullet 2]\n- [Lunch Item 2]\n- [Sub-bullet 1]\n- [Sub-bullet 2]\n 3) Dinner:\n- [Dinner Item 1]\n- [Sub-bullet 1]\n- [Sub-bullet 2]\n- [Dinner Item 2]\n- [Sub-bullet 1]\n- [Sub-bullet 2] \n . and Calculate the BMR and Create a personalized meal based on the following data : age = 20 , weight = 92 , height = 191 ,he has allergies towards gluten and fish so exclude any ingredients containing fish and gluten , his activity dynamic is sitting at a desk all day ,he wants 5 meals per day and his desired weight is to be 80."
#prompt = "generate a diet plan consisting of 3 meals per day , for a 20 year old , his weight is 90 kg and height 180 cm , and exclude fish from the diet ,his target is to lose weight and his desired weight is 80, specify how many grams of each ingredient should the meal contain "
print(askGpt(prompt))
